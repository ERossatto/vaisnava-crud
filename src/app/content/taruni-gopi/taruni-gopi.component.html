<section class="section">

  <!-- CRUD: create, read, update and delete a register. -->

  <div class="logo">
    <img src="../../../assets/taruni-gopi/guru-notes-logo.png" alt="logo">
  </div>

  <!-- Botões da página inicial -->

  <div class="homepage-buttons-box">
    <button class="homepage-buttons-box__button" (click)="toggle.createRegister = true; toggle.registerConfirmation = false">Register new devotee</button>
    <button class="homepage-buttons-box__button" (click)="toggle.readRegister = true; toggle.registerConfirmation = false">Show registers</button>
  </div>

  <!-- Cadastrar novo devoto(a) -->
  <div class="popup-bg" *ngIf="toggle.createRegister">

    <label class="popup-bg__label">Spiritual name</label>
    <input type="text" class="popup-bg__input" [(ngModel)]="devotee.spiritualName" maxlength="30">

    <label class="popup-bg__label">Social name</label>
    <input type="text" class="popup-bg__input" [(ngModel)]="devotee.socialName" maxlength="50">

    <label class="popup-bg__label">City</label>
    <input type="text" class="popup-bg__input" [(ngModel)]="devotee.adress.city" maxlength="50">

    <label class="popup-bg__label">State</label>
    <input type="text" class="popup-bg__input" [(ngModel)]="devotee.adress.state" maxlength="30">

    <label class="popup-bg__label">Country</label>
    <input type="text" class="popup-bg__input" [(ngModel)]="devotee.adress.country" maxlength="30">

    <label class="popup-bg__label">Phone number</label>
    <input type="tel" class="popup-bg__input" [(ngModel)]="devotee.contact.phone" maxlength="20">

    <label class="popup-bg__label">E-mail</label>
    <input type="email" class="popup-bg__input" [(ngModel)]="devotee.contact.email" maxlength="40">

    <div class="input-container">
      <div class="input-container__box">
          <label class="input-container__label">Date of birth</label>
          <input type="date" style="width: 130px;" class="input-box" [(ngModel)]="devotee.dateOfBirth">
      </div>
      <div class="input-container__box">
          <label class="input-container__label">Date of initiation</label>
          <input type="date" style="width: 130px;" class="input-box" [(ngModel)]="devotee.dateOfInitiation">
      </div>
    </div>

    <div class="popup-button-box">
      <button class="popup-button-box__button" (click)="createRegister(devotee)">Register</button>
      <button class="popup-button-box__button" (click)="toggle.createRegister = false">Cancel</button>
    </div>
  </div>

  <!-- Pop-up de confirmação do cadastro -->
  <div class="blur-bg" *ngIf="toggle.registerConfirmation">
    <div class="confirmation-popup" *ngIf="toggle.registerConfirmation">
      <p>Devotee successfully registered!</p>
      <div class="popup-button-box">
        <button class="popup-button-box__button" (click)="toggle.registerConfirmation = false">OK</button>
      </div>
    </div>
  </div>

  <!-- Exibir cadastros existentes -->
  <div class="popup-bg" *ngIf="toggle.readRegister">

    <div class="popup-bg__scrollbox">
      <div class="popup-bg__scrollbox__items" *ngFor="let item of dataBase; index as i">
          <p>
            <span style="font-weight: bold;">
              {{item.spiritualName}}
            </span>
            | {{item.socialName}}
            | {{item.adress.city}}, {{item.adress.state}}, {{item.adress.country}}
            | {{item.contact.phone}}
            | {{item.contact.email}}
            | Date of birth: {{item.dateOfBirth}}
            | Date of initiation: {{item.dateOfInitiation}}
          </p>

          <div class="popup-button-box">
            <button class="popup-button-box__button" (click)="openUpdatePopup(item, i)">Update</button>
            <button class="popup-button-box__button" (click)="confirmDelete(i)">Delete</button>
          </div>
      </div>

      <!-- Pop-up de confirmação do exclusão -->
      <div class="blur-bg" *ngIf="toggle.deleteConfirmation">
        <div class="confirmation-popup delete-confirmation" *ngIf="toggle.deleteConfirmation">
          <p>Are you sure you want to delete this registration?</p>
          <div class="popup-button-box">
            <button class="popup-button-box__button" (click)="deleteRegister(itemToDelete.index)">Delete</button>
            <button class="popup-button-box__button" (click)="toggle.deleteConfirmation = false">Cancel</button>
          </div>
        </div>
      </div>

    </div>

    <div class="popup-button-box">
      <button class="popup-button-box__button read-register-button" (click)="toggle.readRegister = false; toggle.deleteConfirmation = false">x</button>
    </div>
  </div>

  <div class="popup-bg" *ngIf="toggle.updateRegister">
    
    <label class="popup-bg__label">Spiritual name</label>
    <input type="text" class="popup-bg__input" [(ngModel)]="itemToUpdate.item.spiritualName" maxlength="30">

    <label class="popup-bg__label">Social name</label>
    <input type="text" class="popup-bg__input" [(ngModel)]="itemToUpdate.item.socialName" maxlength="50">

    <label class="popup-bg__label">City</label>
    <input type="text" class="popup-bg__input" [(ngModel)]="itemToUpdate.item.adress.city" maxlength="50">

    <label class="popup-bg__label">State</label>
    <input type="text" class="popup-bg__input" [(ngModel)]="itemToUpdate.item.adress.state" maxlength="30">

    <label class="popup-bg__label">Country</label>
    <input type="text" class="popup-bg__input" [(ngModel)]="itemToUpdate.item.adress.country" maxlength="30">

    <label class="popup-bg__label">Phone number</label>
    <input type="tel" class="popup-bg__input" [(ngModel)]="itemToUpdate.item.contact.phone" maxlength="20">

    <label class="popup-bg__label">E-mail</label>
    <input type="email" class="popup-bg__input" [(ngModel)]="itemToUpdate.item.contact.email" maxlength="40">

    <div class="input-container">
      <div class="input-container__box">
          <label class="input-container__label">Date of birth</label>
          <input type="date" style="width: 130px;" class="input-box" [(ngModel)]="itemToUpdate.item.dateOfBirth">
      </div>
      <div class="input-container__box">
          <label class="input-container__label">Date of initiation</label>
          <input type="date" style="width: 130px;" class="input-box" [(ngModel)]="itemToUpdate.item.dateOfInitiation">
      </div>
    </div>

    <div class="popup-button-box">
      <button class="popup-button-box__button" (click)="updateRegister()">Update</button>
      <button class="popup-button-box__button" (click)="toggle.updateRegister = false">Cancel</button>
    </div>
  </div>

  <div class="blur-bg" *ngIf="toggle.updateConfirmation">
    <!-- Pop-up de confirmação do update -->
    <div class="confirmation-popup" *ngIf="toggle.updateConfirmation">
      <p>Devotee successfully updated!</p>
      <div class="popup-button-box">
        <button class="popup-button-box__button" (click)="toggle.updateConfirmation = false">OK</button>
      </div>
    </div>
  </div>

</section>
